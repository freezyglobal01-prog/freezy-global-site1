<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checkout - Freezy Global</title>
<link rel="stylesheet" href="style.css">
<script src="products.js"></script>
<script src="cart.js"></script>
<script src="https://js.paystack.co/v1/inline.js"></script>
</head>
<body>
<header>
<h1>Checkout</h1>
<nav>
<a href="index.html">Home</a>
<a href="services.html">Services</a>
<a href="products.html">Products</a>
<a href="cart.html">Cart</a>
<a href="admin.html">Admin</a>
</nav>
</header>

<section>
<h2>Order Summary</h2>
<div id="cartItems"></div>
<h3 id="cartTotal"></h3>
<button id="payButton">Pay Now</button>
<script>
document.addEventListener("DOMContentLoaded",()=>{
  renderCart();
  document.getElementById("payButton").addEventListener("click",()=>{
    const total = cart.reduce((acc,item)=>acc+item.price*item.qty,0)*100; // kobo
    let handler = PaystackPop.setup({
      key: 'pk_live_31ccec42c86cb47ea9d3b0af6eeb6d2dc9c08291',
      email: 'customer@example.com',
      amount: total,
      currency: 'NGN',
      callback: function(response){
        alert('Payment complete! Reference: '+response.reference);
        clearCart();
        window.location.href="index.html";
      },
      onClose: function(){ alert('Payment closed'); }
    });
    handler.openIframe();
  });
});
</script>
</section>
</body>
</html>
